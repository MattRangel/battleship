(()=>{"use strict";var e={208:(e,t,r)=>{r.d(t,{A:()=>h});var n=r(601),o=r.n(n),a=r(314),i=r.n(a),s=r(417),c=r.n(s),l=new URL(r(950),r.b),d=i()(o()),u=c()(l);d.push([e.id,`.board-grid {\n  display: grid;\n  gap: 0.2rem;\n}\n\n.board-grid {\n  grid-template: repeat(10, 1fr) / repeat(10, 1fr);\n}\n\n.board-container {\n  text-align: center;\n}\n\n.spot {\n  background-color: lightgrey;\n  width: 2rem;\n  aspect-ratio: 1/1;\n}\n\nbutton {\n  cursor: pointer;\n  border: none;\n}\n\nbutton.spot:hover {\n  background-color: darkgrey;\n}\n\nbutton.spot:active {\n  background-color: darkred;\n}\n\n#boards {\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: space-around;\n  max-width: 60rem;\n  margin: 0 auto;\n}\n\n.ship,\n#ship-preview > div {\n  background-color: dimgrey;\n  border-radius: 20%;\n}\n\n#ship-preview {\n  display: flex;\n  gap: 0.2rem;\n  justify-content: center;\n  margin: 1rem 0;\n}\n\n#ship-preview > div {\n  width: 1.5rem;\n  aspect-ratio: 1/1;\n}\n\n.hit {\n  background-image: url(${u});\n  background-size: cover;\n}\n\n.close-modal {\n  background-color: indianred;\n  padding: 0.2rem 1rem;\n  float: right;\n}\n\ndialog > h1 {\n  text-align: center;\n}\n\n.confirm {\n  float: none;\n  background-color: darkseagreen;\n}\n\n#pass-control::backdrop {\n  background-color: dimgray;\n}\n`,""]);const h=d},314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r="",n=void 0!==t[5];return t[4]&&(r+="@supports (".concat(t[4],") {")),t[2]&&(r+="@media ".concat(t[2]," {")),n&&(r+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),r+=e(t),n&&(r+="}"),t[2]&&(r+="}"),t[4]&&(r+="}"),r})).join("")},t.i=function(e,r,n,o,a){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(n)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(i[c]=!0)}for(var l=0;l<e.length;l++){var d=[].concat(e[l]);n&&i[d[0]]||(void 0!==a&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=a),r&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=r):d[2]=r),o&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=o):d[4]="".concat(o)),t.push(d))}},t}},417:e=>{e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},601:e=>{e.exports=function(e){return e[1]}},72:e=>{var t=[];function r(e){for(var r=-1,n=0;n<t.length;n++)if(t[n].identifier===e){r=n;break}return r}function n(e,n){for(var a={},i=[],s=0;s<e.length;s++){var c=e[s],l=n.base?c[0]+n.base:c[0],d=a[l]||0,u="".concat(l," ").concat(d);a[l]=d+1;var h=r(u),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==h)t[h].references++,t[h].updater(p);else{var m=o(p,n);n.byIndex=s,t.splice(s,0,{identifier:u,updater:m,references:1})}i.push(u)}return i}function o(e,t){var r=t.domAPI(t);return r.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}e.exports=function(e,o){var a=n(e=e||[],o=o||{});return function(e){e=e||[];for(var i=0;i<a.length;i++){var s=r(a[i]);t[s].references--}for(var c=n(e,o),l=0;l<a.length;l++){var d=r(a[l]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}a=c}}},659:e=>{var t={};e.exports=function(e,r){var n=function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(r)}},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},56:(e,t,r)=>{e.exports=function(e){var t=r.nc;t&&e.setAttribute("nonce",t)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(r){!function(e,t,r){var n="";r.supports&&(n+="@supports (".concat(r.supports,") {")),r.media&&(n+="@media ".concat(r.media," {"));var o=void 0!==r.layer;o&&(n+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),n+=r.css,o&&(n+="}"),r.media&&(n+="}"),r.supports&&(n+="}");var a=r.sourceMap;a&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},950:(e,t,r)=>{e.exports=r.p+"9f5abf6f6bc8b5909c89.svg"}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={id:n,exports:{}};return e[n](a,a.exports,r),a.exports}r.m=e,r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;r.g.importScripts&&(e=r.g.location+"");var t=r.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var o=n.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=n[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=e})(),r.b=document.baseURI||self.location.href,r.nc=void 0;var n=r(72),o=r.n(n),a=r(825),i=r.n(a),s=r(659),c=r.n(s),l=r(56),d=r.n(l),u=r(540),h=r.n(u),p=r(113),m=r.n(p),f=r(208),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=c().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h(),o()(f.A,g),f.A&&f.A.locals&&f.A.locals;class v{constructor(e){this.length=e,this.hits=0}hit(){this.hits++}isSunk(){return this.hits===this.length}}class y{#e;constructor(){this.#e=10,this.ships=[],this.data=this.constructor.#t(this.#e)}reset(){this.ships=[],this.data=this.constructor.#t(this.#e)}placeShip({position:e,direction:t,length:r}){const n=this.ships.push(new v(r))-1,o=this.#r({position:e,direction:t,length:r});if(this.#n(o))throw new Error("Illegal ship placement!");o.forEach((e=>{this.data[e[0]][e[1]].shipId=n}))}receiveAttack(e){const t=this.data[e[0]][e[1]];t.hit=!0,this.ships[t.shipId]?.hit()}isOver(){return this.ships.every((e=>e.isSunk()))}#r({position:e,direction:t,length:r}){const n=["vertical","horizontal"].indexOf(t);return[...Array(r).keys()].map((t=>{const r=[...e];return r.splice(n,1,e[n]+t),r}))}#n(e){return e.some((e=>e[0]<0||e[1]<0||e[0]>=this.#e||e[1]>=this.#e||!isNaN(this.data[e[0]][e[1]]?.shipId)))}legalPlacements(e){return this.data.flat().filter((e=>isNaN(e?.shipId))).reduce(((t,r)=>{const n=[r.row,r.column];return["vertical","horizontal"].forEach((r=>{this.#n(this.#r({position:n,length:e,direction:r}))||t.push({direction:r,position:n,length:e})})),t}),[])}static#t(e){return[...Array(e)].map(((t,r)=>[...Array(e)].map(((e,t)=>new Object({row:r,column:t})))))}}class b{constructor(e,t){this.isHuman=e,this.name=t,this.board=new y}}function w(e,t,r="",n=!0){const o=document.createElement("div");o.classList.add("board-container");const a=document.createElement("h2");a.innerText=r;const i=document.createElement("div");i.classList.add("board-grid"),o.replaceChildren(a,i),e.forEach(((e,r)=>{e.forEach(((e,o)=>{const a=document.createElement(n&&(t?isNaN(e?.shipId):!e?.hit)?"button":"div");a.classList.add("spot"),a.dataset.row=r,a.dataset.column=o,a.classList.toggle("hit",!!e?.hit),a.classList.toggle("ship",!isNaN(e?.shipId)&&(t||!!e?.hit)),i.appendChild(a)}))}));const s=new Promise((e=>{i.querySelectorAll("button").forEach((t=>t.addEventListener("click",(t=>{const r=t.target.dataset;e([+r.row,+r.column])}))))}));return{element:o,promise:s}}document.querySelectorAll(".close-modal").forEach((e=>e.addEventListener("click",(e=>{e.target.parentElement.close()})))),(new class{#o;constructor(){this.#o=[5,4,3,3,2],this.players=[new b(!0,"Player 1"),new b(!1,"Player 2")]}start(){this.turn=0,this.#a().then((()=>this.#i()))}restart(){for(const e of this.players)e.board.reset();this.start()}get#s(){return this.players[this.turn%2]}get#c(){return this.players[Math.abs(this.turn%2-1)]}get#l(){const e=this.players.findIndex((e=>e.board.isOver()));return this.players[Math.abs(e-1)]}takeTurn(e){this.#c.board.receiveAttack(e),this.turn++,this.#i()}#i(){var e,t;this.#d(),this.#l?(e=this.#l.name,t=()=>this.restart(),document.querySelectorAll(".board-grid button").forEach((e=>e.disabled=!0)),function(e,t){const r=document.querySelector("#win-alert"),n=r.querySelector("h1");r.querySelector(".confirm").addEventListener("click",t),n.innerText=`${e} has won!`,r.showModal()}(e,t)):this.#s.isHuman?this.players.every((e=>e.isHuman))&&function(e){const t=document.querySelector("#pass-control");t.querySelector("h1").innerText=`Pass control to ${e}`,t.showModal()}(this.#s.name):this.takeTurn(this.#u())}#d(){(function(e,t){const r=w(e.board.data,!0,"Your Board",!1),n=w(t.board.data,!1,`${t.name}'s Board`);return document.querySelector("#boards").replaceChildren(r.element,n.element),n.promise})(this.#s,this.#c).then((e=>{this.takeTurn(e)}))}#u(){const e=this.#c.board.data.flat().filter((e=>!e?.hit)),t=e[Math.floor(Math.random()*e.length)];return[t.row,t.column]}async#a(){for(const e of this.players)await this.#h(e,this.#o)}async#p(e,t){return e.isHuman?await async function(e,t){const r=document.querySelector("#ship-preview"),n=[...Array(t)].map((()=>document.createElement("div")));r.replaceChildren(...n);const o=document.querySelector("#board-creation .board-container"),a=w(e.board.data,!0,`${e.name}, Place Your Ships`);o.replaceWith(a.element),document.querySelector("#board-creation").showModal();const i=await a.promise,s=document.querySelector("#place-ship-direction").value;return document.querySelector("#board-creation").close(),{position:i,direction:s,length:t}}(e,t):this.#m(e,t)}async#h(e,t){for(const r of t)for(;;){const t=await this.#p(e,r);try{e.board.placeShip(t);break}catch{document.querySelector("#board-creation").animate({backgroundColor:["revert","darkred","revert"]},750)}}}#m(e,t){const r=e.board.legalPlacements(t);return r[Math.floor(Math.random()*r.length)]}}).start()})();